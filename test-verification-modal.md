# 测试计划：Cloudflare 认证弹窗功能

## 功能概述
将故事生成时的 Cloudflare Turnstile 认证从页面固定组件改为弹窗形式，确保每次生成都能重新进行验证。

## 测试步骤

### 1. 基本功能测试
- [ ] 访问故事生成页面
- [ ] 输入故事内容
- [ ] 选择AI模型
- [ ] 点击"生成故事"按钮
- [ ] 验证认证弹窗是否正常显示
- [ ] 完成Turnstile验证
- [ ] 点击"确认"按钮
- [ ] 验证故事是否开始生成

### 2. 重复生成测试
- [ ] 第一次故事生成完成后
- [ ] 再次点击"生成故事"或"重新生成"按钮
- [ ] 验证认证弹窗是否再次显示
- [ ] 验证Turnstile组件是否重新加载
- [ ] 完成验证并确认生成
- [ ] 验证故事是否正常生成

### 3. 用户体验测试
- [ ] 验证弹窗的标题和描述是否正确显示
- [ ] 验证国际化文本（中英文）是否正确
- [ ] 测试取消按钮是否正常工作
- [ ] 验证弹窗关闭后状态是否正确重置
- [ ] 测试验证失败时的错误处理

### 4. 状态管理测试
- [ ] 验证生成按钮在验证前后的状态变化
- [ ] 测试验证过程中的加载状态
- [ ] 验证模态框状态的正确性
- [ ] 测试回调函数的正确执行

### 5. 兼容性测试
- [ ] 测试不同浏览器的兼容性
- [ ] 测试移动端响应式布局
- [ ] 验证键盘导航支持
- [ ] 测试屏幕阅读器等辅助功能

## 预期结果
1. 用户点击生成按钮时，认证弹窗显示而不是页面固定的认证组件
2. 每次生成都需要重新进行验证，无需刷新页面
3. 验证成功后自动开始故事生成流程
4. 弹窗关闭时正确清理状态
5. 国际化文本正确显示
6. 整体用户体验流畅

## 可能的问题和解决方案
1. **Turnstile组件重置问题**：确保每次弹窗打开时组件重新初始化
2. **状态管理冲突**：检查全局状态是否正确管理
3. **回调函数执行**：确保验证成功后正确调用故事生成函数
4. **国际化缺失**：检查所有语言文件是否包含必要的翻译

## 技术验证点
- AppContext 状态管理正确性
- 认证模态框组件渲染
- 回调函数传递和执行
- Turnstile组件重置机制
- 事件处理函数正确性